<h1 align="center">RL A2 - Group 38</h1>

### Assignment 2 submission for the course Reinforcement Learning 2023/2024 at Leiden University

Contains all the code necessary to run a DQN ablation study on the CartPole-v1 gym environment, as well as (theoretically) any other gym environment with a similar action/observation space configuration. 

### Code dependencies:

`torch` `tqdm` `gymnasium`

#### Usage:

After cloning the git repo, all of the figures shown in the report can be generated by running:

### `make_all_plots.sh`

from the project directory. This will run all the experiments and save the figures in the `figures` directory. The results of the ablation study will be printed to the terminal as well.

---

In case `make_all_plots.sh` is not available, individual experiments can be run with a single command as well. 

##### Note: make sure both a **figures** and a **results** directory exists!

To train the full model:

### `python3 run_experiment.py --filename='classic_dqn'`

To ablate the ER:

### `python3 run_experiment.py --filename='ablate_er' --no_experience_replay`

To ablate the TN:

### `python3 run_experiment.py --filename='ablate_tn' --no_target_network`

To ablate both:

### `python3 run_experiment.py --filename='ablate_both' --no_target_network --no_experience_replay`

The ablation study results can then be compiled by running 

### `python3 ablation_study.py`



To run the exploration strategy comparison, run 

### `python3 run_experiment.py --filename='best_egreedy' --policy='egreedy'`

and to compile the results and produce the comparison plot, run

### `python3 best_explos.py`



Finally, the LunarLander-v2 environment can be used as well. To generate that plot, run:

### `python3 run_experiment.py --filename='lunarlander' --env='LunarLander-v2' --num_repetitions=5`

---

For a more complete run-down of the possible command-line parameters, run

### `python3 run_experiment.py --help`

###### Note: previous results will be used by default if they are available. To fully re-run the experiments, you may want to delete the contents of the results directory first.
